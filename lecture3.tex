\section{Геометрические принципы ТФКП (продолжение)}

\begin{lemma}
	Пусть $\gamma: \intcc{\alpha, \beta} \to \CC$ — замкнутый спрямляемый путь. Пусть $U = U([\gamma])$ — (связная) окрестность носителя $\gamma$. Пусть $f \in \A(U), f(z) ≠ 0 \forall z \in [\gamma]$.

	Тогда $\frac{1}{2 \pi \im} \int_{\gamma} \frac{f'(z)}{f(z)} \dif z = \frac{1}{2 \pi} \DArg{\gamma} f$.
\end{lemma}
\begin{proof}
	Разобьём $\intcc{\alpha, \beta}$ на очень маленькие последовательные отрезки $\intcc{\alpha_{n-1}, \alpha_n}, n = 1, \ldots, N$, так, чтобы для всех $n$ $[\sigma_n] = f([\gamma_n])$ лежал в одной из стандартных полуплоскостей $\PR, \PL, \PP, \PM$; здесь $\gamma_n = \gamma\eval_{\intcc{\alpha_{n-1}, \alpha_n}}$, $\sigma_n = f \circ \gamma_n$, $\DArg{\gamma} f = \DArg{\sigma} w$.

	Пусть $U_n$ — такая (связная) окрестность $[\gamma_n]$, что $f \in \A(U_n)$ и $f(U_n)$ лежит в той же полуплоскости, что и $\sigma_n$. Выберем какую-либо ветвь $\ln_\br{n} z = \ln \abs z + \im \arg_\br{n} z$ в $U_n$. Тогда $\ln_\br{n} f(z) \in \A(U_n)$ \implies $\int_{\gamma_n^+} \frac{f'(z)}{f(z)} \dif z = \int_{\gamma_n^+} \dif \left(\ln_\br{n} f(z) \right) = \ln_\br{n} f(\gamma_n(t)) \eval_{\alpha_{n-1}}^{\alpha_n} = \ln \abs{f(\gamma_n(t))} \eval_{\alpha_{n-1}}^{\alpha_n} + \im \arg_\br{n} f(\gamma_n(t)) \eval_{\alpha_{n-1}}^{\alpha_n}$.
	
	Просуммируем по $n = 1, \ldots, N$. Все логарифмы сократятся, т. к. путь замкнут. А сумма последних слагаемых даст $\DArg{\gamma} f$ (так как $\arg_\br{n} f(\gamma_n(t))\eval_{\alpha_{n-1}}^{\alpha_n} = \DArg{\gamma_n} f$).

	Итого $\int_{\gamma} \frac{f'(z)}{f(z)} \dif z = \im \DArg{\gamma} f$. Делим на $2 \pi \im$.
\end{proof}

\begin{theorem}[Принцип аргумента]
	В условиях теоремы о логарифмических вычетах справедлива формула
	\[ N_D(f) - P_D(f) = \frac{1}{2 \pi} \DArg{\bndp D} f \]
\end{theorem}
\begin{proof}
	Пусть $D$ — допустимая, $\bndp D = \Gamma_1^+ \sqcup \Gamma_2^- \sqcup \ldots \sqcup \Gamma_S^-$.
	$\DArg{\bndp D} f = \DArg{\Gamma_1^+} f - \sum_{s = 2}{S} \DArg{\Gamma_s^+} f$ по определению приращения аргумента вдоль цепи кривых.
	
	Остаётся воспользоваться теоремой о логарифмических вычетах ($f$ голоморфна в окрестности каждой $\Gamma_s$) и предыдущей теоремой.

	\[ N_s(f) - P_s(f) = \int_{\Gamma_s^+} \frac{f'(z)}{f(z)} \dif z = \frac{1}{2 \pi} \DArg{\Gamma_s^+} f \]
\end{proof}
\begin{note}
	Принцип аргумента остаётся верным в следующих более общих условиях:

	Пусть $D$ — область в $\CC$, ограниченная конечным числом попарно непересекающихся замкнутых жордановых кривых (не обязательно спрямляемых), $f$ голоморфна в $D$ за исключениеем конечного числа полюсов $\set{b_1, \ldots, b_M} \subset D$, $f$ непрерывна в $\overline D \setminus \set{b_1, \ldots, b_M}$, $f ≠ 0$ на $\bnd D$.
	
	Тогда $ N_D(f) - P_D(f) = \frac{1}{2 \pi} \DArg{\bndp D} f $.
\end{note}
\begin{exercise*}
	Доказать это утверждение, если дополнительно $f$ голоморфна в окрестности $\bnd D$.
\end{exercise*}

\begin{theorem}[теорема Руше́]
	Пусть $D$ — допустимая область в $\CC$, $f$ и $g$ голоморфны в окрестности $\overline D$, причём $\abs{g(z)} < \abs{f(z)} \forall z \in \bnd D$. Тогда $N_D (f+g) = N_D f$.
\end{theorem}
\begin{proof}
	Очевидно $f ≠ 0$ на $D$, тогда $f + g ≠ 0$ на $D$.

	По принципу аргумента
	\[ N_D (f+g)
	= \frac{1}{2 \pi} \DArg{\bndp D} (f + g)
	= \frac{1}{2 \pi} \DArg{\bndp D} \left(f \left(1 + \frac{g}{f}\right) \right)
	= \frac{1}{2 \pi} \DArg{\bndp D} f + \frac{1}{2 \pi} \DArg{\bndp D} \left(1 + \frac{g}{f}\right) \]
	Но $\frac{1}{2 \pi} \DArg{\bndp D} f = N_D(f)$, остаётся доказать, что $\DArg{\bndp D} \left(1 + \frac{g}{f}\right) = 0$.

	Пусть $\bndp D = \Gamma_1^+ \sqcup \Gamma_2^- \sqcup \ldots \sqcup \Gamma_S^-$. Пусть $\gamma_s^-$ — параметризация $\Gamma_s^-$ на $\intcc{\alpha_s, \beta_s}$. Достаточно доказать, что $\DArg{\gamma_s^-}\left(1 + \frac{g}{f} \right) = 0$.

	\[ \DArg{\gamma_s^-}\left(1 + \frac{g}{f} \right) = \DArg{\left(1 + \frac{g}{f} \right) \circ \gamma_s^-} w \]
	где $\sigma_s = \left(1 + \frac{g}{f} \right) \circ \gamma_s^- $

	$\sigma_s$ — замкнутый путь, $\abs{\frac{g}{f}} < 1$ \implies $1 + \frac{g}{f}$ всегда в $\PP$. Поэтому в качестве $\phi_s(t)$ можно взять $\arg \sigma_s(t)$ (главный аргумент). И тогда получится, что $\DArg{\left(1 + \frac{g}{f} \right) \circ \gamma_s^-} w = \phi_s(\beta_s) - \phi_s(\alpha_s) = \arg{\cdotp}- \arg{\cdotp} = 0$.
\end{proof}
\begin{note}
	Теорема Руше́ верна в более общих условиях, как в принципе аргумента:
	$f \in \A(D), f \in C(\overline D)$.
\end{note}
\begin{example}
	Найти число нулей (с учётом кратности) многочлена $P(z) = z^7 + 4 z + 1$ в кольце $\setw{z}{1 < \abs{z} < 2}$.
	\begin{enumerate}
		\item Рассмотрим $D_2 = \setw{z}{\abs{z} < 2}$. Рассмотрим $f_2(z) = z^7$, $g_2(z) = 4 z + 1$.
		\[\abs{g_2(z)} < \abs{f_2(z)} \forall z \in \bnd D_2 \quad (\abs{z} = 2)\]
		По теореме Руше $N_{D_2}(P) = N_{D_2}(f_2 + g_2) = N_{D_2}(f_2) = 7$.
		\item Аналогично для $D_1 = \setw{z}{\abs{z} < 1}$ рассмотрим $f_1(z) = 4 z$, $g_1(z) = z^7 + 1$, получим $N_{D_1}(P) = 1$.
		\item $N_{D_2 \setminus \overline D_1} = 7 - 1 = 6$.
	\end{enumerate}
\end{example}

\begin{theorem}[Принцип сохранения области]
	Пусть $D$ — произвольная область в $\CC$, $f \in \A(D)$, $f \nequiv \const$. Тогда $\Omega = f(D)$ — область в $\CC$.
\end{theorem}
\begin{proof}
	Связность $\Omega$ очевидна. Нужно доказать открытость.

	Пусть $w_0 \in \Omega$. Тогда $\exists z_0 \in D: f(z_0) = w_0$. Докажем, что $w_0 \in \Omega$ вместе с некоторым кружком.

	Рассмотрим функцию $f(z) - w_0 \neq \const$. $z_0$ — её изолированный ноль \implies $\exists \delta > 0: f \in \A(\text{окрестность} \overline{B(z_0, \delta)})$, $\overline{B(z_0, \delta)} \subset D$, $\min_{\abs{z - z_0} = \delta} \abs{f(z) - w_0} = \eps > 0$. Достаточно доказать, что $B(w_0, \eps) \subset \Omega$.

	Фиксируем любое $w \in B(w_0, \eps)$. В области $B(z_0, \delta) = B_\delta$ применим теорему Руше к функциям $f_1(z) = f(z) - w_0$, $g_1(z) = w_0 - w$ (постоянная).
	\[\abs{g_1(z)} < \eps \leq \abs{f_1(z)} \forall z \in \bnd B_\delta \]
	Поэтому $N_{B_\delta} (f(z) - w) = N_{B_\delta} (f_1(z) + g_1(z)) = N_{B_\delta} (f_1(z)) \geq 1$.
	Значит, в $B_\delta$ $f$ принимает значение $w$ ($\exists z \in B_\delta: f(z) = w \in \Omega$).
\end{proof}

\begin{definition}
	Пусть $D$ — область в $\CC$, $f \in \A(D)$, и $f$ взаимно-однозначна (инъективна) в $D$. Тогда $f$ называется \emph{однолистной} в $D$.
\end{definition}
\begin{note}
	Всякая однолистная функция $f$ в $D$ является гомеоморфизмом $D$ на $\Omega = f(D)$.
\end{note}
\begin{theorem}[О конформности однолистных функций]
	Если $f$ однолистна в области $D$, то $f$ конформна в $D$, т. е. $f'(z) ≠ 0 \forall z \in D$.
\end{theorem}
\begin{lemma}
	Если $a \in \CC$, $f \in \A(a)$, и $f'(a) = 0$, то в любой окрестности $U(a)$ точки $a$ существуют $z_1 ≠ z_2 \in U(a)$: $f(z_1) = f(z_2)$.
\end{lemma}
\begin{proof}
	Пусть $n$ — порядок нуля $f(z) - f(a)$. Если $n = +\infty$, то $f \equiv \const$ (в окрестности $a$) и всё доказано. Пусть $n \in \NN$. Тогда $n \geq 2$, т. к. $(f(z) - f(a))\eval_a = 0$, $(f(z) - f(a))'\eval_a = f'(a) = 0$.
	По теореме о нулях есть $g \in \A(a)$: $g(a) = b ≠ 0$, $f(z) - f(a) = (z - a)^n g(z)$.
	Так как $b ≠ 0$ и $g \in \A(a)$, то существует $\delta > 0$, такое, что $f$ и $g$ голоморфна в $B_\delta$, где $B_\delta = B(a, \delta)$, $g(B_\delta) \subset \P$, где $\P$ — полуплоскость с границей, проходящей через точку 0.
	Тогда существует $\sqrt[n]{w}_\br{} \in \A(\P)$.
	Пусть $g_1(z) = \sqrt[n]{g(z)}_\br{}$ в $B_\delta$. $g_1(z)$ голоморфна \implies $f(z) - f(a) = (S_n \circ h)(z)$, где $S_n(w) = w^n$, $h(z) = (z - a) g_1(z)$. $h(a) = 0$, $h(z)$ непостоянна.

	Рассмотрим любое $\delta_1 < \delta$. Тогда $h(B(a, \delta_1))$ содержит некоторую окрестность 0 (т. к. оно открыто и непостоянно). В этой окрестности существуют различные $w_1, w_2 ≠ 0$: $w_1^n = w_2^n$. Но $\exists z_1, z_2 \in B(a, \delta_1): h(z_1) = w_1, h(z_2) = w_2$. Очевидно, что $z_1 ≠ z_2$. Отсюда $f(z_1) - f(a) = (h(z_1))^n = (h(z_2))^n = f(z_2) - f(a)$ \implies $f(z_1) = f(z_2)$
\end{proof}
\begin{proof}[Доказательство теоремы]
	Из последней леммы от противного следует, что $\forall z f'(z) ≠ 0$, т. к. она взаимно-однозначна.
\end{proof}
\begin{corollary}
	Если $f$ одннолистна в $D$, то $f$ — конформный изоморфизм $D$ и $f(D)$.
\end{corollary}
\begin{proof}
	Конформность $f^{-1}$ вытекает из теоремы об обратной функции, а голоморфность — из теоремы об открытом отображении.
\end{proof}
